\section{\SecMakeconfTool} \label{sec:basic_makeconf}
%------------------------------------------------------

現在、実験のための設定ファイル\verb|**.conf|は\verb|pp, init, run|用に
それぞれ用意することになっているが、本章で説明した通り、
3つの設定ファイルで共通するネームリストが、不一致である場合モデルが動かない。
設定ミスを防ぎ、簡易に設定ファイルを用意するためのサポートツールが
\begin{alltt}
 $ cd ${Tutorial_DIR}/real/
 $ ls
    Makefile : 実験セット一式作成のためのMakeファイル
    README   : 実験セット一式作成ツールに関するREADME
    USER.sh  : 実験設定の指定
    config/  : 実験セット一式作成つーつのためのファイル(ユーザーは基本書き換えない)
\end{alltt}
に用意されている。
これは、初期設定として現実大気実験のチュートリアルに合わせた設定となっているが、
ユーザーが任意の設定に変更することが可能な仕組みとなっている。
本章で説明した箇所の多くを\verb|USER.sh|で設定できるようになっている。


\subsubsection{ツールの使い方}

使い方はREADMEに書かれているように、以下の通りである。
\begin{enumerate}
  \item ユーザーが希望する任意の実験設定に従って、\verb|USER.sh|を編集する。
  \item \verb|make|コマンドを実行する。
  \item 実験に必要な設定ファイル一式が\verb|experiment|ディレクトリ以下に作成される。
\end{enumerate}

現在は、\verb|tutorial|の設定になっているので、
実際には以下のようにチュートリアル設定を残しておくことを勧める。
\begin{verbatim}
 $ mv experiment/ tutorial/    : (すでにexperimentディレクトリがある場合)
 $ cp USER.sh USER_tutorial.sh
 ... USER.shを編集 ...
 $ make
 $ cp -rL experiment 任意の場所/ : SCALEのソースがあるディレクトリ以外の場所も可
\end{verbatim}


\subsubsection{\texttt{USER.sh}の編集}

まず、ドメインの数を指定する。\verb|NUM_DOMAIN|が1であればネストなし、
2以上であればオンラインネスティングの設定で複数ドメイン用の設定ファイル(\verb|**.conf|)と
ランチャーファイル(\verb|**.launch.conf|)が用意される。
オフラインネスティングには対応していない。
\begin{verbatim}
  NUM_DOMAIN=1 # set number of domains
\end{verbatim}

その下には、設定ファイルのネームリストで設定する項目が並んでいるので、
それぞれの項目の設定を書き込んでいけば良い。
\verb|"# required parameters for each domain"| というコメントがあるところには
ドメインの数だけ設定変数をスペースで区切って用意する。
この時、\verb|NUM_DOMAIN|で設定したネスティングドメインの数と変数の数が不一致だと
メッセージが出力され、実験セットが作成されずに終了してしまうので必ず一致させること。
\verb|USER.sh|にない項目については、デフォルトの設定で出力されるので
\verb|experiment|ディレクトリ以下に作成された設定ファイルを直接変更すればよい。

